<!DOCTYPE html>
<head>

    <script src="../js/jquery-1.11.1.min.js"></script>
    <script src="../dist/orgy.devel.js"></script>
    
<script>

    var dependencies = [
        {
            comment : "Document ready."
            ,id : "DOMContentLoaded"
            ,type : "event"
        },{
            url : "data/data2.json"
            ,type : "json"
        }
    ];
    var q = Orgy.queue(dependencies);

    //FIRES WHEN RESOLVED
    q.then(function(r){
        console.log(r); //Result of dependencies
        return 1;
    });
    
    //FIRES WHEN RESOLVED
    q.then(function(r,deferred,last){
        console.log(last); //1
        return 2;
    });
    
    //FIRES WHEN RESOLVED
    q.then(function(r,deferred,last){
        console.log(last); //2
        return def; //tricky - def declared before this but written in subsequent lines
    });

    console.log("Creating a deferred that will hold up the callback chain...");
    var def = Orgy.deferred();
    setTimeout(function(){
      console.log("Resolving the example deferred to resume the chain...");
      def.resolve(1000);
    },'1000');
    
    //FIRES WHEN RESOLVED
    q.then(function(r,deferred,last){
         //last is the deferred "def". to get its value, use .value
        console.log(last.value);
        return last.value;
    });
  
    q.done(function(r,deferred,last){
      console.log("Chain end value:",last);
      console.log("Dependency values:");
      console.log(r);
    });
</script>
</head>
<body>
    <div>
        Check javascript console for messages.
    </div>
</body>
</html>